<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Egenkontroll N√¶ringsbygg</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <style>
    :root {
      --bg: #f4f6f9;
      --card: #fff;
      --primary: #4a90e2;
      --accent: #50e3c2;
      --text: #333;
      --shadow: rgba(0, 0, 0, 0.05);
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); }
    header { background: var(--primary); color: #fff; padding: 1rem; text-align: center; }
    .container { max-width: 800px; margin: auto; padding: 1rem; }
    .card {
      background: var(--card);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px var(--shadow);
    }
    .card h2 {
      display: flex;
      align-items: center;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    .card h2 i { margin-right: 0.5rem; color: var(--accent); }
    label {
      display: flex;
      align-items: center;
      margin: 0.4rem 0;
    }
    input[type="checkbox"] { margin-right: 0.75rem; width: 1.1em; height: 1.1em; }
    textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: vertical;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 1rem;
    }
    button {
      flex: 1;
      padding: 0.75rem;
      border: none;
      border-radius: 5px;
      background: var(--primary);
      color: #fff;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { opacity: 0.9; }
    @media (max-width: 600px) {
      .buttons { flex-direction: column; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Egenkontroll N√¶ringsbygg</h1>
  </header>

  <div class="container">
    <form id="form">
      <!-- Seksjon 1: Bygg -->
      <div class="card">
        <h2><i class="fa-solid fa-building"></i> 1. Bygningsmessig tilstand</h2>
        <label><input type="checkbox" name="bygg1"> Fasade og yttervegger er fri for skader</label>
        <label><input type="checkbox" name="bygg2"> Tak er tett, ingen synlige lekkasjer</label>
        <label><input type="checkbox" name="bygg3"> Vinduer og d√∏rer fungerer og lukker tett</label>
        <label><input type="checkbox" name="bygg4"> R√∏mningsveier er frie og tydelig merket</label>
        <label><input type="checkbox" name="bygg5"> Trapper og rekkverk er sikre og i god stand</label>
      </div>

      <!-- Seksjon 2: Brannsikkerhet -->
      <div class="card">
        <h2><i class="fa-solid fa-fire"></i> 2. Brannsikkerhet</h2>
        <label><input type="checkbox" name="brann1"> Brannalarmanlegg fungerer og er testet</label>
        <label><input type="checkbox" name="brann2"> R√∏ykvarslere er korrekt plassert og virker</label>
        <label><input type="checkbox" name="brann3"> Slokkeutstyr er tilgjengelig og kontrollert</label>
        <label><input type="checkbox" name="brann4"> Branninstruks og r√∏mningsplan er oppsl√•tt</label>
        <label><input type="checkbox" name="brann5"> N√∏dlys fungerer som de skal</label>
      </div>

      <!-- Seksjon 3: Elektrisk anlegg -->
      <div class="card">
        <h2><i class="fa-solid fa-bolt"></i> 3. Elektrisk anlegg</h2>
        <label><input type="checkbox" name="el1"> Sikringsskap er tilgjengelige og merket</label>
        <label><input type="checkbox" name="el2"> Ingen synlige skader p√• ledninger</label>
        <label><input type="checkbox" name="el3"> Alle kontakter er hele og trygge</label>
        <label><input type="checkbox" name="el4"> Jordfeilbryter er testet nylig</label>
        <label><input type="checkbox" name="el5"> N√∏dbelysning fungerer</label>
      </div>

      <!-- Seksjon 4: VVS og ventilasjon -->
      <div class="card">
        <h2><i class="fa-solid fa-wind"></i> 4. VVS og ventilasjon</h2>
        <label><input type="checkbox" name="vvs1"> Ingen lekkasjer p√• r√∏r eller kraner</label>
        <label><input type="checkbox" name="vvs2"> Vanntrykk og temperatur er tilfredsstillende</label>
        <label><input type="checkbox" name="vvs3"> Ventilasjon fungerer og har rene filtre</label>
        <label><input type="checkbox" name="vvs4"> Kj√∏ling og varme fungerer</label>
      </div>

      <!-- Seksjon 5: Renhold og hygiene -->
      <div class="card">
        <h2><i class="fa-solid fa-broom"></i> 5. Renhold og hygiene</h2>
        <label><input type="checkbox" name="rh1"> Avfallsbeholdere er tilgjengelige og t√∏mmes</label>
        <label><input type="checkbox" name="rh2"> Sanit√¶ranlegg er rene og fungerer</label>
        <label><input type="checkbox" name="rh3"> Rengj√∏ringsrutiner f√∏lges</label>
        <label><input type="checkbox" name="rh4"> S√•pe og papir er tilgjengelig</label>
      </div>

      <!-- Seksjon 6: Universell utforming -->
      <div class="card">
        <h2><i class="fa-solid fa-accessible-icon"></i> 6. Universell utforming</h2>
        <label><input type="checkbox" name="uu1"> Inngang er trinnfri eller tilrettelagt</label>
        <label><input type="checkbox" name="uu2"> Tilgjengelig toalett for rullestolbrukere</label>
        <label><input type="checkbox" name="uu3"> Informasjonsskilt er lett lesbare</label>
        <label><input type="checkbox" name="uu4"> Tilrettelegging for synshemmede</label>
      </div>

      <!-- Notater -->
      <div class="card">
        <h2><i class="fa-solid fa-note-sticky"></i> Notater</h2>
        <textarea name="notater" rows="4" placeholder="Skriv dine observasjoner eller avvik her..."></textarea>
      </div>

      <!-- Knappene -->
      <div class="buttons">
        <button type="button" onclick="lagre()">üíæ Lagre</button>
        <button type="button" onclick="hent()">üîÑ Hent</button>
        <button type="button" onclick="nullstill()">üóëÔ∏è Nullstill</button>
        <button type="button" onclick="eksporterPDF()">üìÑ PDF</button>
        <button type="button" onclick="eksporterExcel()">üìä Excel</button>
      </div>
    </form>
  </div>

  <!-- JS-libs og funksjoner -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    const n√∏kkel = 'egenkontroll-data';

    function lagre() {
      const data = {};
      [...document.forms[0].elements].forEach(el => {
        if (el.name) data[el.name] = el.type === 'checkbox' ? el.checked : el.value;
      });
      localStorage.setItem(n√∏kkel, JSON.stringify(data));
      alert('‚úîÔ∏è Lagret');
    }

    function hent() {
      const data = JSON.parse(localStorage.getItem(n√∏kkel) || '{}');
      [...document.forms[0].elements].forEach(el => {
        if (data.hasOwnProperty(el.name)) {
          if (el.type === 'checkbox') el.checked = data[el.name];
          else el.value = data[el.name];
        }
      });
    }

    function nullstill() {
      if (confirm('Slette all lagret data?')) {
        localStorage.removeItem(n√∏kkel);
        document.forms[0].reset();
      }
    }

    async function eksporterPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit: 'pt', format: 'a4' });
      doc.text('Egenkontroll N√¶ringsbygg', 40, 40);
      let y = 70;
      const data = JSON.parse(localStorage.getItem(n√∏kkel) || '{}');
      for (const [key, val] of Object.entries(data)) {
        const v = typeof val === 'boolean' ? (val ? '‚úÖ' : '‚ùå') : val;
        doc.text(`${key}: ${v}`, 40, y);
        y += 20;
        if (y > 780) { doc.addPage(); y = 40; }
      }
      doc.save('egenkontroll.pdf');
    }

    function eksporterExcel() {
      const data = JSON.parse(localStorage.getItem(n√∏kkel) || '{}');
      const ws = XLSX.utils.json_to_sheet([data]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Egenkontroll');
      XLSX.writeFile(wb, 'egenkontroll.xlsx');
    }

    window.onload = hent;
  </script>
</body>
</html>
