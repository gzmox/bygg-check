<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Egenkontroll N√¶ringsbygg</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>

  <style>
    :root {
      --bg: #f0f2f5;
      --card: #fff;
      --primary: #4a90e2;
      --accent: #50e3c2;
      --text: #333;
      --shadow: rgba(0,0,0,0.1);
    }
    * {box-sizing: border-box;}
    body {margin:0; font-family:sans-serif; background: var(--bg); color: var(--text);}
    header {background: var(--primary); padding: 1em; color: #fff; text-align:center;}
    .container {max-width: 800px; margin: auto; padding: 1em;}
    .card {background: var(--card); border-radius: 8px; margin:1em 0; padding:1em; box-shadow: 0 4px 12px var(--shadow);}
    .card h2 {display:flex; align-items:center; font-size:1.2rem;}
    .card h2 i {margin-right:0.5em; color: var(--accent);}
    label {display:flex; align-items:center; margin:0.5em 0;}
    input[type=checkbox] {margin-right:0.75em; width:1.1em; height:1.1em;}
    textarea {width:100%; padding:0.75em; resize:vertical; border:1px solid #ddd; border-radius:4px;}
    textarea:focus, input:focus {outline:none; border-color: var(--primary);}
    .buttons {display:flex; flex-wrap:wrap; gap:0.75em; margin:1em 0;}
    button {flex:1; min-width:120px; padding:0.75em; border:none; border-radius:4px; background:var(--primary); color:#fff; cursor:pointer; font-weight:bold;}
    button:hover {opacity:0.9;}
    @media (max-width:600px) {
      .buttons {flex-direction:column;}
    }
  </style>
</head>
<body>
  <header><h1>Egenkontroll N√¶ringsbygg</h1></header>
  <div class="container">
    <form id="form">
      <!-- Bygg -->
      <div class="card">
        <h2><i class="fa-solid fa-building"></i> Bygg</h2>
        <label><input type="checkbox" name="bygg1"> Fasade/yttervegger</label>
        <label><input type="checkbox" name="bygg2"> Tak uten lekkasjer</label>
        <label><input type="checkbox" name="bygg3"> Vinduer og d√∏rer</label>
      </div>

      <!-- Brann -->
      <div class="card">
        <h2><i class="fa-solid fa-fire"></i> Brann</h2>
        <label><input type="checkbox" name="brann1"> Brannalarmanlegg testet</label>
        <label><input type="checkbox" name="brann2"> R√∏ykvarslere</label>
        <label><input type="checkbox" name="brann3"> Slokkeutstyr</label>
      </div>

      <!-- Elektrisk -->
      <div class="card">
        <h2><i class="fa-solid fa-bolt"></i> Elektrisk</h2>
        <label><input type="checkbox" name="elk1"> Sikringsskap og tavler</label>
        <label><input type="checkbox" name="elk2"> Ingen skadet ledning</label>
        <label><input type="checkbox" name="elk3"> N√∏dbelys fungerer</label>
      </div>

      <!-- VVS/Vent -->
      <div class="card">
        <h2><i class="fa-solid fa-wind"></i> VVS / Ventilasjon</h2>
        <label><input type="checkbox" name="vvs1"> Ingen lekkasjer</label>
        <label><input type="checkbox" name="vvs2"> Ventilasjon filtrert</label>
        <label><input type="checkbox" name="vvs3"> Temperatur og trykk OK</label>
      </div>

      <!-- Renhold -->
      <div class="card">
        <h2><i class="fa-solid fa-broom"></i> Renhold / Hygiene</h2>
        <label><input type="checkbox" name="rh1"> Avfallsh√•ndtering</label>
        <label><input type="checkbox" name="rh2"> Sanit√¶ranlegg ryddige</label>
      </div>

      <!-- Universell -->
      <div class="card">
        <h2><i class="fa-solid fa-accessible-icon"></i> Universell utforming</h2>
        <label><input type="checkbox" name="uni1"> Trinnfri inngang</label>
        <label><input type="checkbox" name="uni2"> Tilgjengelig toalett</label>
      </div>

      <!-- Notater -->
      <div class="card">
        <h2><i class="fa-solid fa-sticky-note"></i> Notater</h2>
        <textarea name="notes" rows="4" placeholder="Skriv her..."></textarea>
      </div>

      <div class="buttons">
        <button type="button" onclick="save()">üíæ Lagre</button>
        <button type="button" onclick="load()">üîÑ Hent</button>
        <button type="button" onclick="resetAll()">üóëÔ∏è Nullstill</button>
        <button type="button" onclick="exportPDF()">üìÑ Eksporter PDF</button>
        <button type="button" onclick="exportXLS()">üìä Eksporter Excel</button>
      </div>
    </form>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    const key = 'egenkontroll-data';

    function save() {
      const data = {};
      [...document.getElementById('form').elements].forEach(el => {
        if (el.name) data[el.name] = el.type==='checkbox'? el.checked : el.value;
      });
      localStorage.setItem(key, JSON.stringify(data));
      alert('Lagret!');
    }

    function load() {
      const data = JSON.parse(localStorage.getItem(key) || '{}');
      [...document.getElementById('form').elements].forEach(el => {
        if (data.hasOwnProperty(el.name)) {
          if (el.type === 'checkbox') el.checked = data[el.name];
          else el.value = data[el.name];
        }
      });
    }

    function resetAll() {
      if (confirm('Slette all data?')) {
        localStorage.removeItem(key);
        document.getElementById('form').reset();
      }
    }

    // PDF-export
    async function exportPDF() {
      load();
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ unit:'pt', format:'a4' });
      doc.text('Egenkontroll N√¶ringsbygg', 40, 40);
      let y = 70;
      [...document.getElementById('form').elements].forEach(el => {
        if (el.name && el.type !== 'button') {
          const label = el.closest('label')?.innerText || el.name;
          const val = el.type === 'checkbox' ? (el.checked ? '‚úÖ' : '‚ùå') : el.value;
          doc.text(`${label}: ${val}`, 40, y);
          y += 20;
          if (y > 750){ doc.addPage(); y = 40; }
        }
      });
      doc.save('egenkontroll.pdf');
    }

    // Excel-export
    function exportXLS() {
      load();
      const data = {};
      [...document.getElementById('form').elements].forEach(el => {
        if (el.name) data[el.name] = el.type==='checkbox'? (el.checked?1:0) : el.value;
      });
      const ws = XLSX.utils.json_to_sheet([data]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'Egenkontroll');
      XLSX.writeFile(wb, 'egenkontroll.xlsx');
    }

    window.onload = load;
  </script>
</body>
</html>
